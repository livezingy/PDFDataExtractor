# PDFPlumber è¡¨æ ¼æå–æœºåˆ¶å®Œå…¨æŒ‡å—

## ğŸ“‹ æ–‡æ¡£æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»pdfplumberåº“çš„è¡¨æ ¼æå–æœºåˆ¶ï¼ŒåŒ…æ‹¬lineså’Œtextæ¨¡å¼çš„å¤„ç†æµç¨‹ã€æ‰€æœ‰å‚æ•°çš„å®˜æ–¹å®šä¹‰ã€ä½œç”¨èŒƒå›´ä»¥åŠå‚æ•°è®¾å®šä¾æ®ã€‚

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**ç”Ÿæˆæ—¶é—´**: 2025-10-30  
**å‚è€ƒæ¥æº**: pdfplumberå®˜æ–¹æºä»£ç  (table.py)

---

## ğŸ”„ è¡¨æ ¼æå–å¤„ç†æµç¨‹

### 1. Linesæ¨¡å¼å¤„ç†æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. è¾“å…¥: PDF Page                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. æå–PDFåŸç”Ÿçº¿æ¡å¯¹è±¡                                        â”‚
â”‚    - page.lines (ç›´çº¿)                                       â”‚
â”‚    - page.rects (çŸ©å½¢è¾¹ç¼˜)                                   â”‚
â”‚    - page.curves (æ›²çº¿åˆ†æ®µ)                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. è½¬æ¢ä¸ºEdges (è¾¹ç¼˜å¯¹è±¡)                                     â”‚
â”‚    - æ ‡å‡†åŒ–ä¸ºç»Ÿä¸€æ ¼å¼                                         â”‚
â”‚    - æ ‡è®°æ–¹å‘: 'h'(æ°´å¹³) / 'v'(å‚ç›´)                         â”‚
â”‚    - åŒ…å«åæ ‡: {x0, x1, top, bottom, orientation}            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. åº”ç”¨ snap_tolerance - å¸é™„å¹³è¡Œçº¿                          â”‚
â”‚    - æ°´å¹³çº¿: æŒ‰ top åæ ‡åˆ†ç»„ï¼Œè·ç¦» < snap_y_tolerance åˆå¹¶   â”‚
â”‚    - å‚ç›´çº¿: æŒ‰ x0 åæ ‡åˆ†ç»„ï¼Œè·ç¦» < snap_x_tolerance åˆå¹¶    â”‚
â”‚    - åˆå¹¶åˆ°ä½ç½®å¹³å‡å€¼                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. åº”ç”¨ join_tolerance - è¿æ¥æ–­è£‚çº¿æ®µ                        â”‚
â”‚    - åŒä¸€ç›´çº¿ä¸Šçš„çº¿æ®µæŒ‰åæ ‡æ’åº                               â”‚
â”‚    - ç«¯ç‚¹è·ç¦» < join_tolerance çš„çº¿æ®µåˆå¹¶                    â”‚
â”‚    - å½¢æˆå®Œæ•´çš„é•¿çº¿æ®µ                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. åº”ç”¨ edge_min_length - è¿‡æ»¤çŸ­è¾¹ç¼˜                         â”‚
â”‚    - è¿‡æ»¤é•¿åº¦ < edge_min_length çš„è¾¹ç¼˜                       â”‚
â”‚    - å»é™¤å™ªå£°å’Œè£…é¥°æ€§çŸ­çº¿                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. è®¡ç®—äº¤ç‚¹ - edges_to_intersections                         â”‚
â”‚    - éå†æ‰€æœ‰å‚ç›´è¾¹å’Œæ°´å¹³è¾¹çš„ç»„åˆ                             â”‚
â”‚    - ä½¿ç”¨ intersection_tolerance åˆ¤æ–­æ˜¯å¦ç›¸äº¤                â”‚
â”‚    - æ¡ä»¶: v.top â‰¤ h.top+tol AND v.bottom â‰¥ h.top-tol       â”‚
â”‚           AND v.x0 â‰¥ h.x0-tol AND v.x0 â‰¤ h.x1+tol           â”‚
â”‚    - è®°å½•äº¤ç‚¹åæ ‡: (x, y)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. æ„å»ºå•å…ƒæ ¼ - intersections_to_cells                       â”‚
â”‚    - éå†æ‰€æœ‰äº¤ç‚¹å¯¹                                           â”‚
â”‚    - æ£€æŸ¥å››ä¸ªè§’ç‚¹æ˜¯å¦å½¢æˆçŸ©å½¢                                 â”‚
â”‚    - éªŒè¯è¾¹ç¼˜è¿æ¥æ€§                                           â”‚
â”‚    - ç”Ÿæˆå•å…ƒæ ¼è¾¹ç•Œæ¡†: (x0, top, x1, bottom)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 9. ç»„åˆè¡¨æ ¼ - cells_to_tables                                â”‚
â”‚    - æŸ¥æ‰¾å…±äº«è§’ç‚¹çš„å•å…ƒæ ¼                                     â”‚
â”‚    - å°†ç›¸é‚»å•å…ƒæ ¼åˆ†ç»„ä¸ºè¡¨æ ¼                                   â”‚
â”‚    - è¿‡æ»¤å•å•å…ƒæ ¼è¡¨æ ¼                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 10. è¾“å‡º: Tableå¯¹è±¡åˆ—è¡¨                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Textæ¨¡å¼å¤„ç†æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. è¾“å…¥: PDF Page                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. æå–æ–‡æœ¬å¯¹è±¡ - page.extract_words()                       â”‚
â”‚    - åº”ç”¨ text_x_tolerance: å­—ç¬¦æ°´å¹³é—´è·é˜ˆå€¼                 â”‚
â”‚    - åº”ç”¨ text_y_tolerance: å­—ç¬¦å‚ç›´åå·®é˜ˆå€¼                 â”‚
â”‚    - ç»„åˆå­—ç¬¦ä¸ºå•è¯                                           â”‚
â”‚    - å•è¯æ ¼å¼: {text, x0, x1, top, bottom}                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. ç”Ÿæˆè™šæ‹Ÿæ°´å¹³è¾¹ç¼˜ - words_to_edges_h()                     â”‚
â”‚    - æŒ‰ top åæ ‡èšç±»å•è¯ (tolerance=1)                       â”‚
â”‚    - è¿‡æ»¤: æ¯è¡Œè‡³å°‘ min_words_horizontal ä¸ªå•è¯              â”‚
â”‚    - ä¸ºæ¯è¡Œç”Ÿæˆä¸¤æ¡æ°´å¹³è¾¹ç¼˜:                                  â”‚
â”‚      * è¡Œé¡¶éƒ¨è¾¹ç¼˜ (top)                                      â”‚
â”‚      * è¡Œåº•éƒ¨è¾¹ç¼˜ (bottom)                                   â”‚
â”‚    - å®½åº¦: ä»æœ€å·¦å•è¯åˆ°æœ€å³å•è¯                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. ç”Ÿæˆè™šæ‹Ÿå‚ç›´è¾¹ç¼˜ - words_to_edges_v()                     â”‚
â”‚    - æŒ‰ x0, x1, center åˆ†åˆ«èšç±»å•è¯ (tolerance=1)           â”‚
â”‚    - è¿‡æ»¤: æ¯åˆ—è‡³å°‘ min_words_vertical ä¸ªå•è¯                â”‚
â”‚    - å»é™¤é‡å çš„èšç±»                                           â”‚
â”‚    - ä¸ºæ¯ä¸ªå¯¹é½ä½ç½®ç”Ÿæˆå‚ç›´è¾¹ç¼˜                               â”‚
â”‚    - é«˜åº¦: ä»æœ€é¡¶å•è¯åˆ°æœ€åº•å•è¯                               â”‚
â”‚    - é¢å¤–æ·»åŠ æœ€å³è¾¹ç¼˜                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5-10. ä¸Linesæ¨¡å¼ç›¸åŒçš„å¤„ç†æµç¨‹                               â”‚
â”‚    - åº”ç”¨ snap_tolerance                                     â”‚
â”‚    - åº”ç”¨ join_tolerance                                     â”‚
â”‚    - åº”ç”¨ edge_min_length                                    â”‚
â”‚    - è®¡ç®—äº¤ç‚¹ (intersection_tolerance)                       â”‚
â”‚    - æ„å»ºå•å…ƒæ ¼                                               â”‚
â”‚    - ç»„åˆè¡¨æ ¼                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¾“å‡º: Tableå¯¹è±¡åˆ—è¡¨                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Linesä¸Textæ¨¡å¼å¯¹æ¯”

| ç»´åº¦ | Linesæ¨¡å¼ | Textæ¨¡å¼ |
|------|----------|---------|
| **è¾¹ç¼˜æ¥æº** | PDFåŸç”Ÿçº¿æ¡å¯¹è±¡ | æ–‡æœ¬å¯¹é½ä½ç½®ç”Ÿæˆè™šæ‹Ÿè¾¹ç¼˜ |
| **é€‚ç”¨åœºæ™¯** | æœ‰æ¡†è¡¨æ ¼ (æ˜æ˜¾è¾¹æ¡†çº¿) | æ— æ¡†è¡¨æ ¼ (ä¾èµ–æ–‡æœ¬å¯¹é½) |
| **ä¼˜åŠ¿** | ç²¾ç¡®ã€ç›´æ¥ | æ— éœ€çº¿æ¡ä¹Ÿèƒ½è¯†åˆ« |
| **åŠ£åŠ¿** | éœ€è¦æ˜æ˜¾çº¿æ¡ | ä¾èµ–æ–‡æœ¬å¯¹é½è´¨é‡ |
| **ç‰¹æœ‰å‚æ•°** | æ—  | `text_x_tolerance`, `text_y_tolerance`, `min_words_vertical`, `min_words_horizontal` |
| **å…±ç”¨å‚æ•°** | `snap_tolerance`, `join_tolerance`, `edge_min_length`, `intersection_tolerance` | åŒå·¦ |
| **å¤„ç†æµç¨‹** | ç¬¬3æ­¥åä¸Textæ¨¡å¼ç›¸åŒ | ç¬¬5æ­¥åä¸Linesæ¨¡å¼ç›¸åŒ |

**å…³é”®ç»“è®º**: 
- âœ… **snap_tolerance, join_tolerance, edge_min_length, intersection_tolerance åœ¨ä¸¤ç§æ¨¡å¼ä¸‹å‡æœ‰æ•ˆ**
- âœ… ä¸¤ç§æ¨¡å¼çš„æ ¸å¿ƒå·®å¼‚ä»…åœ¨è¾¹ç¼˜ç”Ÿæˆæ–¹å¼ï¼Œåç»­å¤„ç†æµç¨‹å®Œå…¨ä¸€è‡´

---

## ğŸ“– å‚æ•°è¯¦ç»†è¯´æ˜

### ç­–ç•¥å‚æ•°

#### 1. vertical_strategy

**å®˜æ–¹å®šä¹‰**:
> æ§åˆ¶å¦‚ä½•æ£€æµ‹è¡¨æ ¼çš„å‚ç›´è¾¹ç•Œ

**å¯é€‰å€¼**:
- `"lines"`: ä½¿ç”¨PDFåŸç”Ÿçº¿æ¡å¯¹è±¡ (page.lines, page.rects, page.curves)
- `"text"`: ä½¿ç”¨æ–‡æœ¬å¯¹è±¡çš„å¯¹é½ä½ç½®
- `"lines_strict"`: ä»…ä½¿ç”¨page.lines (ä¸åŒ…æ‹¬çŸ©å½¢å’Œæ›²çº¿)
- `"explicit"`: ä½¿ç”¨æ˜ç¡®æŒ‡å®šçš„çº¿æ¡ä½ç½®

**ä½œç”¨**:
å†³å®šå‚ç›´è¾¹ç¼˜çš„ç”Ÿæˆæ–¹å¼ï¼Œå½±å“è¡¨æ ¼åˆ—çš„è¯†åˆ«

**ç¤ºä¾‹**:
```python
# æœ‰æ¡†è¡¨æ ¼ - ä½¿ç”¨å®é™…çº¿æ¡
table_settings = {
    "vertical_strategy": "lines"
}

# æ— æ¡†è¡¨æ ¼ - ä½¿ç”¨æ–‡æœ¬å¯¹é½
table_settings = {
    "vertical_strategy": "text"
}
```

**å½±å“èŒƒå›´**:
- â­â­â­â­â­ è¡¨æ ¼åˆ—è¾¹ç•Œè¯†åˆ«
- â­â­â­â­â­ å•å…ƒæ ¼å‚ç›´åˆ†å‰²
- â­â­â­â­ è¡¨æ ¼æ£€æµ‹æˆåŠŸç‡

**å¯ç”¨äºè®¾å®šçš„PDFé¡µé¢å±æ€§**:
| PDFå±æ€§ | æ¨èå€¼ | è¯´æ˜ |
|---------|--------|------|
| å‚ç›´çº¿æ¡æ•°é‡ | â‰¥5æ¡ â†’ `"lines"` | å……è¶³çš„å‚ç›´çº¿æ¡ |
| å‚ç›´çº¿æ¡æ•°é‡ | <5æ¡ â†’ `"text"` | çº¿æ¡ä¸è¶³æˆ–ç¼ºå¤± |
| æ–‡æœ¬åˆ—å¯¹é½åº¦ | é«˜ â†’ `"text"` | æ–‡æœ¬åˆ—è¾¹ç•Œæ¸…æ™° |
| çº¿æ¡è´¨é‡ | æ¨¡ç³Š/æ–­è£‚ â†’ `"text"` | çº¿æ¡è´¨é‡å·® |
| è¡¨æ ¼ç±»å‹ | æœ‰æ¡† â†’ `"lines"` | æ˜æ˜¾è¾¹æ¡† |
| è¡¨æ ¼ç±»å‹ | æ— æ¡† â†’ `"text"` | ä¾èµ–å¯¹é½ |

---

#### 2. horizontal_strategy

**å®˜æ–¹å®šä¹‰**:
> æ§åˆ¶å¦‚ä½•æ£€æµ‹è¡¨æ ¼çš„æ°´å¹³è¾¹ç•Œ

**å¯é€‰å€¼**: 
åŒ `vertical_strategy`

**ä½œç”¨**:
å†³å®šæ°´å¹³è¾¹ç¼˜çš„ç”Ÿæˆæ–¹å¼ï¼Œå½±å“è¡¨æ ¼è¡Œçš„è¯†åˆ«

**ç¤ºä¾‹**:
```python
# æ··åˆç­–ç•¥ - å‚ç›´ç”¨çº¿æ¡ï¼Œæ°´å¹³ç”¨æ–‡æœ¬
table_settings = {
    "vertical_strategy": "lines",
    "horizontal_strategy": "text"  # å¸¸è§é…ç½®
}
```

**å½±å“èŒƒå›´**:
- â­â­â­â­â­ è¡¨æ ¼è¡Œè¾¹ç•Œè¯†åˆ«
- â­â­â­â­â­ å•å…ƒæ ¼æ°´å¹³åˆ†å‰²
- â­â­â­â­ å¤šè¡Œå†…å®¹åˆ†ç¦»

**å¯ç”¨äºè®¾å®šçš„PDFé¡µé¢å±æ€§**:
| PDFå±æ€§ | æ¨èå€¼ | è¯´æ˜ |
|---------|--------|------|
| æ°´å¹³çº¿æ¡æ•°é‡ | â‰¥10æ¡ â†’ `"lines"` | å……è¶³çš„æ°´å¹³çº¿æ¡ |
| æ°´å¹³çº¿æ¡æ•°é‡ | <10æ¡ â†’ `"text"` | çº¿æ¡ä¸è¶³ |
| æ–‡æœ¬è¡Œå¯¹é½åº¦ | é«˜ â†’ `"text"` | æ–‡æœ¬è¡Œè¾¹ç•Œæ¸…æ™° |
| è£…é¥°æ€§çº¿æ¡ | å­˜åœ¨ â†’ `"text"` | é¿å…å¹²æ‰° |

---

### Linesæ¨¡å¼å‚æ•° (åœ¨Textæ¨¡å¼ä¸‹åŒæ ·æœ‰æ•ˆ)

#### 3. snap_tolerance

**å®˜æ–¹å®šä¹‰**:
> Parallel lines within snap_tolerance points will be snapped to the same horizontal or vertical position.

**ä¸­æ–‡ç¿»è¯‘**:
è·ç¦»åœ¨snap_toleranceç‚¹æ•°å†…çš„å¹³è¡Œçº¿å°†è¢«"å¸é™„"åˆ°ç›¸åŒçš„æ°´å¹³æˆ–å‚ç›´ä½ç½®ã€‚

**ä½œç”¨**:
- åˆå¹¶ä½ç½®æ¥è¿‘çš„å¹³è¡Œçº¿
- æ¶ˆé™¤å¾®å°çš„åæ ‡åå·®
- æé«˜è¡¨æ ¼è¯†åˆ«çš„é²æ£’æ€§

**å·¥ä½œåŸç†**:
```python
# æºä»£ç å®ç° (table.py: snap_edges)
def snap_edges(edges, x_tolerance, y_tolerance):
    """
    1. æŒ‰æ–¹å‘åˆ†ç»„: å‚ç›´çº¿(v) / æ°´å¹³çº¿(h)
    2. å‚ç›´çº¿æŒ‰ x0 èšç±»ï¼Œtolerance=x_tolerance
    3. æ°´å¹³çº¿æŒ‰ top èšç±»ï¼Œtolerance=y_tolerance
    4. æ¯ç»„å†…çš„çº¿å¸é™„åˆ°å¹³å‡ä½ç½®
    """
```

**ç¤ºä¾‹**:
```python
# åœºæ™¯ï¼šPDFæœ‰å¾®å°æ¸²æŸ“åå·®
åŸå§‹å‚ç›´çº¿:
  Line1: x=100.0
  Line2: x=100.5  # åå·®0.5pt
  Line3: x=101.2  # åå·®1.2pt

è®¾ç½® snap_tolerance=2:
  â†’ ä¸‰æ¡çº¿éƒ½å¸é™„åˆ° x=100.57 (å¹³å‡å€¼)
  â†’ è¯†åˆ«ä¸ºåŒä¸€åˆ—è¾¹ç•Œ âœ…

è®¾ç½® snap_tolerance=0.5:
  â†’ Line1, Line2 å¸é™„åˆ° x=100.25
  â†’ Line3 ä¿æŒç‹¬ç«‹
  â†’ è¯†åˆ«ä¸ºä¸¤åˆ—è¾¹ç•Œ âš ï¸
```

**å½±å“èŒƒå›´**:
- â­â­â­â­ çº¿æ¡åˆå¹¶è´¨é‡
- â­â­â­â­ å•å…ƒæ ¼å¯¹é½ç²¾åº¦
- â­â­â­ è¡¨æ ¼è¯†åˆ«å®¹é”™æ€§
- âš ï¸ **é£é™©**: è¿‡å¤§å¯èƒ½é”™è¯¯åˆå¹¶ä¸åŒä½ç½®çš„çº¿æ¡

**å¯ç”¨äºè®¾å®šçš„PDFé¡µé¢å±æ€§**:
| PDFå±æ€§ | è®¡ç®—å…¬å¼ | è¯´æ˜ |
|---------|----------|------|
| å­—ç¬¦æœ€å°å®½åº¦ | `min_char_width * 0.3~0.5` | åŸºäºå†…å®¹å°ºå¯¸ |
| å­—ç¬¦æœ€å°é«˜åº¦ | `min_char_height * 0.3~0.5` | åŸºäºå†…å®¹å°ºå¯¸ |
| çº¿æ¡æœ€å°é—´è· | `min_line_spacing * 0.05~0.1` | é—´è·çš„5-10% |
| PDFç±»å‹ | æ‰«æPDF â†’ å¢å¤§ (0.5~1.0) | å®¹å¿æ›´å¤§åå·® |
| PDFç±»å‹ | åŸç”ŸPDF â†’ å‡å° (0.2~0.5) | ç²¾ç¡®è¯†åˆ« |
| çº¿æ¡æŠ–åŠ¨å¹…åº¦ | `line_jitter_std * 2~3` | è¦†ç›–2-3å€æ ‡å‡†å·® |

**æ¨èèŒƒå›´**: 0.5 ~ 5.0 ç‚¹

---

#### 4. join_tolerance

**å®˜æ–¹å®šä¹‰**:
> Line segments on the same infinite line, and whose ends are within join_tolerance of one another, will be joined into a single line segment.

**ä¸­æ–‡ç¿»è¯‘**:
ä½äºåŒä¸€ç›´çº¿ä¸Šï¼Œä¸”ç«¯ç‚¹è·ç¦»åœ¨join_toleranceå†…çš„çº¿æ®µå°†è¢«è¿æ¥æˆä¸€æ¡çº¿æ®µã€‚

**ä½œç”¨**:
- è¿æ¥æ–­è£‚çš„çº¿æ¡ç‰‡æ®µ
- ä¿®å¤PDFæ¸²æŸ“å¯¼è‡´çš„çº¿æ¡æ–­è£‚
- å½¢æˆå®Œæ•´çš„è¡¨æ ¼è¾¹ç•Œ

**å·¥ä½œåŸç†**:
```python
# æºä»£ç å®ç° (table.py: join_edge_group)
def join_edge_group(edges, orientation, tolerance):
    """
    1. æŒ‰èµ·ç‚¹åæ ‡æ’åº
    2. æ£€æŸ¥ç›¸é‚»çº¿æ®µç«¯ç‚¹è·ç¦»
    3. è·ç¦» â‰¤ tolerance: åˆå¹¶ï¼Œæ‰©å±•åˆ°æœ€è¿œç«¯ç‚¹
    4. è·ç¦» > tolerance: ä¿æŒç‹¬ç«‹
    """
    sorted_edges = sorted(edges, key='x0'/'top')
    for e in sorted_edges[1:]:
        if e.start <= (last.end + tolerance):
            last.end = e.end  # æ‰©å±•
        else:
            joined.append(e)  # ç‹¬ç«‹
```

**ç¤ºä¾‹**:
```python
# åœºæ™¯ï¼šè¡¨æ ¼çº¿æ¡æ–­è£‚
åŸå§‹æ°´å¹³çº¿æ®µ:
  Segment1: (100, 50) â†’ (200, 50)
  Segment2: (203, 50) â†’ (300, 50)  # é—´éš”3pt
  Segment3: (310, 50) â†’ (400, 50)  # é—´éš”10pt

è®¾ç½® join_tolerance=5:
  â†’ Segment1 + Segment2 åˆå¹¶: (100, 50) â†’ (300, 50) âœ…
  â†’ Segment3 ä¿æŒç‹¬ç«‹: (310, 50) â†’ (400, 50)
  
è®¾ç½® join_tolerance=12:
  â†’ å…¨éƒ¨åˆå¹¶: (100, 50) â†’ (400, 50) âš ï¸ (å¯èƒ½é”™è¯¯)
```

**å½±å“èŒƒå›´**:
- â­â­â­â­â­ æ–­è£‚çº¿æ¡ä¿®å¤
- â­â­â­â­ è¡¨æ ¼è¾¹ç•Œå®Œæ•´æ€§
- â­â­â­ å•å…ƒæ ¼è¿ç»­æ€§
- âš ï¸ **é£é™©**: è¿‡å¤§å¯èƒ½é”™è¯¯è¿æ¥ä¸ç›¸å…³çº¿æ®µ

**å¯ç”¨äºè®¾å®šçš„PDFé¡µé¢å±æ€§**:
| PDFå±æ€§ | è®¡ç®—å…¬å¼ | è¯´æ˜ |
|---------|----------|------|
| çº¿æ¡ç«¯ç‚¹æœ€å°è·ç¦» | `min_endpoint_dist * 1.2~1.5` | ç•¥å¤§äºæœ€å°é—´éš” |
| å­—ç¬¦å¹³å‡å®½åº¦ | `avg_char_width * 0.5~1.0` | åŸºäºå†…å®¹å°ºå¯¸ |
| å•å…ƒæ ¼æœ€å°å®½åº¦ | `min_cell_width * 0.1~0.2` | å•å…ƒæ ¼å®½åº¦çš„10-20% |
| PDFæ¸²æŸ“è´¨é‡ | ä½è´¨é‡ â†’ å¢å¤§ (5~10) | å®¹å¿æ›´å¤§æ–­è£‚ |
| PDFæ¸²æŸ“è´¨é‡ | é«˜è´¨é‡ â†’ å‡å° (1~3) | ç²¾ç¡®è¿æ¥ |
| æ‰«æåˆ†è¾¨ç‡ | ä½åˆ†è¾¨ç‡ â†’ å¢å¤§ | è¡¥å¿æ¸²æŸ“è¯¯å·® |

**æ¨èèŒƒå›´**: 1.0 ~ 10.0 ç‚¹

---

#### 5. edge_min_length

**å®˜æ–¹å®šä¹‰**:
> Edges shorter than edge_min_length will be discarded before attempting to reconstruct the table.

**ä¸­æ–‡ç¿»è¯‘**:
çŸ­äºedge_min_lengthçš„è¾¹ç¼˜å°†åœ¨é‡å»ºè¡¨æ ¼å‰è¢«ä¸¢å¼ƒã€‚

**ä½œç”¨**:
- è¿‡æ»¤å™ªå£°çº¿æ¡
- å»é™¤è£…é¥°æ€§çŸ­çº¿
- å‡å°‘æ— æ•ˆè¾¹ç¼˜å¹²æ‰°
- æé«˜å¤„ç†æ€§èƒ½

**å·¥ä½œåŸç†**:
```python
# æºä»£ç å®ç° (utils/geometry.py: filter_edges)
def filter_edges(edges, min_length):
    """
    1. è®¡ç®—è¾¹ç¼˜é•¿åº¦: height (å‚ç›´) / width (æ°´å¹³)
    2. è¿‡æ»¤: length >= min_length
    """
    return [e for e in edges if e['height'/'width'] >= min_length]
```

**ç¤ºä¾‹**:
```python
# åœºæ™¯ï¼šPDFåŒ…å«è£…é¥°æ€§çŸ­çº¿
é¡µé¢çº¿æ¡:
  Line1: é•¿åº¦=150pt (è¡¨æ ¼è¾¹æ¡†) â†’ ä¿ç•™ âœ…
  Line2: é•¿åº¦=80pt (è¡¨æ ¼è¾¹æ¡†) â†’ ä¿ç•™ âœ…
  Line3: é•¿åº¦=5pt (è£…é¥°çº¿) â†’ è¿‡æ»¤ âœ…
  Line4: é•¿åº¦=2pt (å™ªå£°) â†’ è¿‡æ»¤ âœ…

è®¾ç½® edge_min_length=10:
  â†’ åªä¿ç•™ Line1, Line2
  â†’ è¡¨æ ¼è¯†åˆ«å‡†ç¡® âœ…

è®¾ç½® edge_min_length=100:
  â†’ åªä¿ç•™ Line1
  â†’ Line2 è¢«é”™è¯¯è¿‡æ»¤ï¼Œè¡¨æ ¼è¯†åˆ«å¤±è´¥ âŒ
```

**å½±å“èŒƒå›´**:
- â­â­â­â­ å™ªå£°è¿‡æ»¤æ•ˆæœ
- â­â­â­ è£…é¥°çº¿è¿‡æ»¤
- â­â­â­ å¤„ç†æ€§èƒ½
- âš ï¸ **é£é™©**: è¿‡å¤§å¯èƒ½è¿‡æ»¤æ‰å°å•å…ƒæ ¼çš„çœŸå®è¾¹æ¡†

**å¯ç”¨äºè®¾å®šçš„PDFé¡µé¢å±æ€§**:
| PDFå±æ€§ | è®¡ç®—å…¬å¼ | è¯´æ˜ |
|---------|----------|------|
| å­—ç¬¦æœ€å°å®½åº¦ | `min_char_width * 0.8~1.2` | ç•¥å°äºå­—ç¬¦å®½åº¦ |
| å­—ç¬¦å¹³å‡å®½åº¦ | `avg_char_width * 0.5~1.0` | åŸºäºå¹³å‡å°ºå¯¸ |
| å•å…ƒæ ¼æœ€å°å°ºå¯¸ | `min_cell_size * 0.3~0.5` | ä¿ç•™å°å•å…ƒæ ¼ |
| è£…é¥°çº¿é•¿åº¦åˆ†å¸ƒ | `percentile(line_lengths, 10)` | è¿‡æ»¤æœ€çŸ­10%çº¿æ¡ |
| è¡¨æ ¼ç±»å‹ | æœ‰æ¡† â†’ å‡å° (2~10) | ä¿ç•™çŸ­è¾¹æ¡† |
| è¡¨æ ¼ç±»å‹ | æ— æ¡† â†’ å¢å¤§ (5~20) | è¿‡æ»¤è£…é¥°çº¿ |
| å™ªå£°æ°´å¹³ | é«˜å™ªå£° â†’ å¢å¤§ | æ›´ä¸¥æ ¼è¿‡æ»¤ |

**æ¨èèŒƒå›´**: 1.0 ~ 30.0 ç‚¹

**ç‰¹åˆ«æ³¨æ„**:
- âš ï¸ å¯¹äºæœ‰å¤§é—´è·è£…é¥°æ€§çº¿æ¡çš„æ— æ¡†è¡¨æ ¼ï¼Œ**ä¸åº”ä½¿ç”¨çº¿æ¡é•¿åº¦ä½œä¸ºå‚è€ƒ**
- âœ… **åº”ä½¿ç”¨å­—ç¬¦å°ºå¯¸** (æœ€å°å®½åº¦/é«˜åº¦) ä½œä¸ºè®¾å®šä¾æ®

---

#### 6. intersection_tolerance

**å®˜æ–¹å®šä¹‰**:
> When combining edges into cells, orthogonal edges must be within intersection_tolerance points to be considered intersecting.

**ä¸­æ–‡ç¿»è¯‘**:
å½“ç»„åˆè¾¹ç¼˜ä¸ºå•å…ƒæ ¼æ—¶ï¼Œæ­£äº¤è¾¹ç¼˜å¿…é¡»åœ¨intersection_toleranceç‚¹æ•°å†…æ‰è¢«è§†ä¸ºç›¸äº¤ã€‚

**ä½œç”¨**:
- åˆ¤æ–­å‚ç›´è¾¹å’Œæ°´å¹³è¾¹æ˜¯å¦ç›¸äº¤
- å®¹å¿è¾¹ç¼˜å¯¹é½çš„å¾®å°åå·®
- å½±å“äº¤ç‚¹è¯†åˆ«å’Œå•å…ƒæ ¼æ„å»º

**å·¥ä½œåŸç†**:
```python
# æºä»£ç å®ç° (table.py: edges_to_intersections)
def edges_to_intersections(edges, x_tolerance, y_tolerance):
    """
    åˆ¤æ–­å‚ç›´è¾¹(v)å’Œæ°´å¹³è¾¹(h)æ˜¯å¦ç›¸äº¤:
    
    ç›¸äº¤æ¡ä»¶ (å…¨éƒ¨æ»¡è¶³):
    1. v.top <= h.top + y_tolerance     # å‚ç›´è¾¹é¡¶éƒ¨ä¸ä½äºæ°´å¹³è¾¹
    2. v.bottom >= h.top - y_tolerance  # å‚ç›´è¾¹åº•éƒ¨ä¸é«˜äºæ°´å¹³è¾¹
    3. v.x0 >= h.x0 - x_tolerance       # å‚ç›´è¾¹ä¸åœ¨æ°´å¹³è¾¹å·¦ä¾§å¤ªè¿œ
    4. v.x0 <= h.x1 + x_tolerance       # å‚ç›´è¾¹ä¸åœ¨æ°´å¹³è¾¹å³ä¾§å¤ªè¿œ
    
    æ»¡è¶³æ¡ä»¶ â†’ è®°å½•äº¤ç‚¹: (v.x0, h.top)
    """
```

**ç¤ºä¾‹**:
```python
# åœºæ™¯ï¼šè¾¹ç¼˜æœ‰è½»å¾®åç§»
å‚ç›´è¾¹: x=100, top=50, bottom=150
æ°´å¹³è¾¹: x0=98, x1=200, top=100

ç²¾ç¡®æ£€æŸ¥ (tolerance=0):
  â†’ v.x0(100) >= h.x0(98) âœ…
  â†’ v.x0(100) <= h.x1(200) âœ…
  â†’ ä½†å¦‚æœ v.x0=97.5 < h.x0=98 â†’ ä¸ç›¸äº¤ âŒ

å®¹å·®æ£€æŸ¥ (x_tolerance=3, y_tolerance=3):
  â†’ v.x0(97.5) >= h.x0(98)-3 â†’ 97.5 >= 95 âœ…
  â†’ è¯†åˆ«ä¸ºç›¸äº¤ âœ…
```

**ç¤ºæ„å›¾**:
```
å®¹å·®åŒºåŸŸç¤ºæ„:

    h.x0-tol         h.x0          h.x1        h.x1+tol
        â”‚              â”‚              â”‚            â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â† h.top+y_tol
        â”‚    âŒ        â”‚      âœ…      â”‚     âŒ     â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â† h.top (æ°´å¹³è¾¹)
        â”‚    âŒ        â”‚      âœ…      â”‚     âŒ     â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â† h.top-y_tol
                       â”‚
                       â””â”€ v.x0 (å‚ç›´è¾¹) å¿…é¡»åœ¨æ­¤èŒƒå›´å†…
```

**å½±å“èŒƒå›´**:
- â­â­â­â­â­ äº¤ç‚¹è¯†åˆ«å‡†ç¡®æ€§
- â­â­â­â­ å•å…ƒæ ¼æ„å»ºæˆåŠŸç‡
- â­â­â­â­ è¡¨æ ¼å®Œæ•´æ€§
- âš ï¸ **é£é™©**: è¿‡å¤§å¯èƒ½äº§ç”Ÿé”™è¯¯äº¤ç‚¹ï¼Œè¿‡å°å¯èƒ½é—æ¼çœŸå®äº¤ç‚¹

**æ¨¡å¼é€‚ç”¨æ€§**:
- âœ… **Linesæ¨¡å¼**: æœ‰æ•ˆ
- âœ… **Textæ¨¡å¼**: æœ‰æ•ˆ
- ğŸ“Œ **å…³é”®**: æ— è®ºå“ªç§æ¨¡å¼ç”Ÿæˆçš„edgesï¼Œéƒ½éœ€è¦è®¡ç®—äº¤ç‚¹

**å¯ç”¨äºè®¾å®šçš„PDFé¡µé¢å±æ€§**:
| PDFå±æ€§ | è®¡ç®—å…¬å¼ | è¯´æ˜ |
|---------|----------|------|
| å­—ç¬¦å¹³å‡å®½åº¦ | `avg_char_width * 0.3~0.5` | åŸºäºå†…å®¹å°ºå¯¸ |
| å­—ç¬¦æœ€å°å®½åº¦ | `min_char_width * 0.5~0.8` | æ›´ä¸¥æ ¼çš„åŸºå‡† |
| çº¿æ¡å¯¹é½ç²¾åº¦ | `line_alignment_std * 2~3` | è¦†ç›–2-3å€æ ‡å‡†å·® |
| snap_tolerance | `snap_tolerance * 1.0~1.5` | ä¸å¸é™„å®¹å·®åŒ¹é… |
| PDFæ¸²æŸ“ç²¾åº¦ | é«˜ç²¾åº¦ â†’ å‡å° (1~3) | ç²¾ç¡®å¯¹é½ |
| PDFæ¸²æŸ“ç²¾åº¦ | ä½ç²¾åº¦ â†’ å¢å¤§ (3~8) | å®¹å¿åå·® |
| æ‰«æPDF | æ‰«æ â†’ å¢å¤§ (5~10) | å¯¹é½è¯¯å·®å¤§ |

**æ¨èèŒƒå›´**: 1.0 ~ 10.0 ç‚¹

---

### Textæ¨¡å¼ç‰¹æœ‰å‚æ•°

#### 7. min_words_vertical

**å®˜æ–¹å®šä¹‰**:
> When using "vertical_strategy": "text", at least min_words_vertical words must share the same alignment.

**ä¸­æ–‡ç¿»è¯‘**:
å½“ä½¿ç”¨textå‚ç›´ç­–ç•¥æ—¶ï¼Œè‡³å°‘éœ€è¦min_words_verticalä¸ªå•è¯å…±äº«ç›¸åŒå¯¹é½ä½ç½®ã€‚

**ä½œç”¨**:
- æ§åˆ¶åˆ—è¾¹ç•Œè¯†åˆ«çš„çµæ•åº¦
- è¿‡æ»¤å¶ç„¶å¯¹é½çš„å•è¯
- é¿å…è¯¯è¯†åˆ«åˆ—

**å·¥ä½œåŸç†**:
```python
# æºä»£ç å®ç° (table.py: words_to_edges_v)
def words_to_edges_v(words, word_threshold):
    """
    1. æŒ‰ x0 (å·¦å¯¹é½) èšç±»å•è¯
    2. æŒ‰ x1 (å³å¯¹é½) èšç±»å•è¯
    3. æŒ‰ center (ä¸­å¿ƒå¯¹é½) èšç±»å•è¯
    4. è¿‡æ»¤: len(cluster) >= word_threshold
    5. ä¸ºæ¯ä¸ªåˆæ ¼èšç±»ç”Ÿæˆå‚ç›´è¾¹ç¼˜
    """
    by_x0 = cluster_objects(words, 'x0', tolerance=1)
    by_x1 = cluster_objects(words, 'x1', tolerance=1)
    by_center = cluster_objects(words, center, tolerance=1)
    
    large_clusters = [c for c in all_clusters if len(c) >= word_threshold]
    return [generate_edge(c) for c in large_clusters]
```

**ç¤ºä¾‹**:
```python
# åœºæ™¯ï¼šæ— æ¡†è¡¨æ ¼åˆ—è¯†åˆ«
é¡µé¢æœ‰20è¡Œæ–‡æœ¬ï¼Œ3åˆ—æ•°æ®

åˆ—A (x=100):
  8ä¸ªå•è¯å¯¹é½åœ¨ x=100

åˆ—B (x=200):
  7ä¸ªå•è¯å¯¹é½åœ¨ x=200
  
å¶ç„¶å¯¹é½ (x=150):
  2ä¸ªå•è¯ç¢°å·§å¯¹é½åœ¨ x=150

è®¾ç½® min_words_vertical=3:
  â†’ åˆ—A: 8ä¸ªå•è¯ >= 3 â†’ è¯†åˆ«ä¸ºåˆ— âœ…
  â†’ åˆ—B: 7ä¸ªå•è¯ >= 3 â†’ è¯†åˆ«ä¸ºåˆ— âœ…
  â†’ x=150: 2ä¸ªå•è¯ < 3 â†’ å¿½ç•¥ âœ…

è®¾ç½® min_words_vertical=8:
  â†’ åˆ—A: 8ä¸ªå•è¯ >= 8 â†’ è¯†åˆ«ä¸ºåˆ— âœ…
  â†’ åˆ—B: 7ä¸ªå•è¯ < 8 â†’ å¿½ç•¥ âŒ (é”™è¯¯)
```

**å½±å“èŒƒå›´**:
- â­â­â­â­â­ åˆ—è¾¹ç•Œè¯†åˆ«çµæ•åº¦
- â­â­â­â­ è¯¯æ£€é˜²æ­¢
- â­â­â­ çŸ­è¡¨æ ¼è¯†åˆ«
- âš ï¸ **é£é™©**: è¿‡å¤§å¯èƒ½é—æ¼çœŸå®åˆ—ï¼Œè¿‡å°å¯èƒ½è¯¯è¯†åˆ«

**å¯ç”¨äºè®¾å®šçš„PDFé¡µé¢å±æ€§**:
| PDFå±æ€§ | è®¡ç®—å…¬å¼ | è¯´æ˜ |
|---------|----------|------|
| é¡µé¢æ€»è¡Œæ•° | `total_lines * 0.15~0.25` | è¡Œæ•°çš„15-25% |
| è¡¨æ ¼é¢„ä¼°è¡Œæ•° | `table_rows * 0.25~0.35` | è¡¨æ ¼è¡Œæ•°çš„25-35% |
| æ–‡æœ¬è¡Œæ•° | çŸ­è¡¨(<10è¡Œ) â†’ 2~3 | é™ä½é˜ˆå€¼ |
| æ–‡æœ¬è¡Œæ•° | ä¸­è¡¨(10-30è¡Œ) â†’ 3~6 | é€‚ä¸­é˜ˆå€¼ |
| æ–‡æœ¬è¡Œæ•° | é•¿è¡¨(>30è¡Œ) â†’ 6~10 | æé«˜é˜ˆå€¼,è®¾ä¸Šé™ |
| åˆ—å¯¹é½è´¨é‡ | é«˜è´¨é‡ â†’ å‡å° | å¯¹é½ç¨³å®š |
| åˆ—å¯¹é½è´¨é‡ | ä½è´¨é‡ â†’ å¢å¤§ | é¿å…è¯¯æ£€ |

**æ¨èèŒƒå›´**: 2 ~ 10 ä¸ªå•è¯

**æ¨èè®¾ç½®é€»è¾‘**:
```python
# å¸¦ä¸Šä¸‹é™çš„è‡ªé€‚åº”è®¡ç®—
min_words = int(total_lines * 0.2)
min_words_vertical = max(3, min(min_words, 10))
# ä¸‹é™3: é¿å…è¿‡äºæ•æ„Ÿ
# ä¸Šé™10: é¿å…å¯¹é•¿é¡µé¢è¿‡äºä¸¥æ ¼
```

---

#### 8. min_words_horizontal

**å®˜æ–¹å®šä¹‰**:
> When using "horizontal_strategy": "text", at least min_words_horizontal words must share the same alignment.

**ä¸­æ–‡ç¿»è¯‘**:
å½“ä½¿ç”¨textæ°´å¹³ç­–ç•¥æ—¶ï¼Œè‡³å°‘éœ€è¦min_words_horizontalä¸ªå•è¯å…±äº«ç›¸åŒå¯¹é½ä½ç½®ã€‚

**ä½œç”¨**:
- æ§åˆ¶è¡Œè¾¹ç•Œè¯†åˆ«çš„çµæ•åº¦
- è¿‡æ»¤å­¤ç«‹å•è¯
- é¿å…è¯¯è¯†åˆ«è¡Œ

**å·¥ä½œåŸç†**:
```python
# æºä»£ç å®ç° (table.py: words_to_edges_h)
def words_to_edges_h(words, word_threshold):
    """
    1. æŒ‰ top åæ ‡èšç±»å•è¯ (tolerance=1)
    2. è¿‡æ»¤: len(cluster) >= word_threshold
    3. ä¸ºæ¯è¡Œç”Ÿæˆä¸¤æ¡æ°´å¹³è¾¹ç¼˜:
       - è¡Œé¡¶éƒ¨ (top)
       - è¡Œåº•éƒ¨ (bottom)
    """
    by_top = cluster_objects(words, 'top', tolerance=1)
    large_clusters = [c for c in by_top if len(c) >= word_threshold]
    
    edges = []
    for cluster in large_clusters:
        edges.append(top_edge)     # è¡Œé¡¶
        edges.append(bottom_edge)  # è¡Œåº•
    return edges
```

**ç¤ºä¾‹**:
```python
# åœºæ™¯ï¼šæ— æ¡†è¡¨æ ¼è¡Œè¯†åˆ«
é¡µé¢æœ‰å¤šè¡Œæ–‡æœ¬

è¡Œ1 (top=100): 5ä¸ªå•è¯
è¡Œ2 (top=120): 4ä¸ªå•è¯
è¡Œ3 (top=140): 6ä¸ªå•è¯
å­¤ç«‹å•è¯ (top=160): 1ä¸ªå•è¯

è®¾ç½® min_words_horizontal=2:
  â†’ è¡Œ1: 5ä¸ªå•è¯ >= 2 â†’ è¯†åˆ«ä¸ºè¡Œ âœ…
  â†’ è¡Œ2: 4ä¸ªå•è¯ >= 2 â†’ è¯†åˆ«ä¸ºè¡Œ âœ…
  â†’ è¡Œ3: 6ä¸ªå•è¯ >= 2 â†’ è¯†åˆ«ä¸ºè¡Œ âœ…
  â†’ å­¤ç«‹: 1ä¸ªå•è¯ < 2 â†’ å¿½ç•¥ âœ…

è®¾ç½® min_words_horizontal=5:
  â†’ è¡Œ2: 4ä¸ªå•è¯ < 5 â†’ å¿½ç•¥ âŒ (é”™è¯¯)
```

**å½±å“èŒƒå›´**:
- â­â­â­â­ è¡Œè¾¹ç•Œè¯†åˆ«çµæ•åº¦
- â­â­â­ æ ‡é¢˜/é¡µè„šè¿‡æ»¤
- â­â­â­ å­¤ç«‹æ–‡æœ¬è¿‡æ»¤
- âš ï¸ **é£é™©**: è¿‡å¤§å¯èƒ½é—æ¼å°‘åˆ—è¡¨æ ¼

**å¯ç”¨äºè®¾å®šçš„PDFé¡µé¢å±æ€§**:
| PDFå±æ€§ | è®¡ç®—å…¬å¼ | è¯´æ˜ |
|---------|----------|------|
| è¡¨æ ¼é¢„ä¼°åˆ—æ•° | `table_columns * 0.3~0.5` | åˆ—æ•°çš„30-50% |
| è¡¨æ ¼åˆ—æ•° | 2åˆ—è¡¨æ ¼ â†’ 1 | ä¿ç•™åŒåˆ—è¡¨æ ¼ |
| è¡¨æ ¼åˆ—æ•° | 3-5åˆ—è¡¨æ ¼ â†’ 2~3 | é€‚ä¸­é˜ˆå€¼ |
| è¡¨æ ¼åˆ—æ•° | >5åˆ—è¡¨æ ¼ â†’ 3~5 | æé«˜é˜ˆå€¼ |
| é¡µé¢å¸ƒå±€ | å•åˆ—æ–‡æœ¬ â†’ 1 | è¯†åˆ«å•åˆ— |
| é¡µé¢å¸ƒå±€ | å¤šåˆ—å¸ƒå±€ â†’ 2~3 | è¿‡æ»¤è¾¹ç¼˜å•è¯ |

**æ¨èèŒƒå›´**: 1 ~ 5 ä¸ªå•è¯

**å…¸å‹å€¼**: 
- `1`: ä¿å®ˆè®¾ç½®ï¼Œè¯†åˆ«æ‰€æœ‰å¯èƒ½çš„è¡Œï¼ˆåŒ…æ‹¬å•åˆ—è¡¨æ ¼ï¼‰
- `2`: å¹³è¡¡è®¾ç½®ï¼Œè¿‡æ»¤å­¤ç«‹å•è¯
- `3+`: ä¸¥æ ¼è®¾ç½®ï¼Œä»…è¯†åˆ«å®½è¡¨æ ¼

---

#### 9. text_x_tolerance

**å®˜æ–¹å®šä¹‰**:
> When using text strategy, individual letters in each word are expected to be no more than text_x_tolerance points apart.

**ä¸­æ–‡ç¿»è¯‘**:
å½“ä½¿ç”¨æ–‡æœ¬ç­–ç•¥æ—¶ï¼ŒåŒä¸€å•è¯ä¸­çš„å­—ç¬¦é—´è·ä¸åº”è¶…è¿‡text_x_toleranceç‚¹æ•°ã€‚

**ä½œç”¨**:
- æ§åˆ¶å­—ç¬¦å¦‚ä½•ç»„åˆæˆå•è¯
- å½±å“å•è¯è¯†åˆ«è¾¹ç•Œ
- é—´æ¥å½±å“åˆ—å¯¹é½æ£€æµ‹

**å·¥ä½œåŸç†**:
```python
# åœ¨ page.extract_words() ä¸­ä½¿ç”¨
def extract_words(chars, x_tolerance):
    """
    1. æŒ‰ top åæ ‡èšç±»å­—ç¬¦ (åŒä¸€è¡Œ)
    2. åœ¨æ¯è¡Œå†…ï¼ŒæŒ‰ x0 åæ ‡æ’åºå­—ç¬¦
    3. å¦‚æœç›¸é‚»å­—ç¬¦è·ç¦» <= x_tolerance:
       â†’ åˆå¹¶ä¸ºåŒä¸€å•è¯
    4. å¦åˆ™:
       â†’ å¼€å§‹æ–°å•è¯
    """
```

**ç¤ºä¾‹**:
```python
# åœºæ™¯ï¼šå­—ç¬¦ç»„åˆæˆå•è¯
å­—ç¬¦åºåˆ—:
  'H' at x=100
  'e' at x=105  # è·ç¦»5pt
  'l' at x=108  # è·ç¦»3pt
  'l' at x=111  # è·ç¦»3pt
  'o' at x=114  # è·ç¦»3pt
  ' '
  'W' at x=125  # è·ç¦»11pt
  'o' at x=130  # è·ç¦»5pt

è®¾ç½® text_x_tolerance=6:
  â†’ "Hello" (H-e-l-l-o åˆå¹¶ï¼Œé—´è·éƒ½â‰¤6) âœ…
  â†’ "Wo" (W-o åˆå¹¶) âœ…
  â†’ è¯†åˆ«ä¸ºä¸¤ä¸ªå•è¯ âœ…

è®¾ç½® text_x_tolerance=3:
  â†’ "H" (ç‹¬ç«‹ï¼Œeè·ç¦»5pt>3) âŒ
  â†’ "ello" (e-l-l-o åˆå¹¶) âŒ
  â†’ å•è¯è¢«é”™è¯¯åˆ†å‰² âŒ
```

**å½±å“èŒƒå›´**:
- â­â­â­â­ å•è¯è¯†åˆ«å‡†ç¡®æ€§
- â­â­â­ åˆ—å¯¹é½æ£€æµ‹
- â­â­â­ æ–‡æœ¬æå–è´¨é‡
- âš ï¸ **é£é™©**: è¿‡å¤§å¯èƒ½åˆå¹¶å¤šä¸ªå•è¯ï¼Œè¿‡å°å¯èƒ½åˆ†å‰²å•è¯

**å¯ç”¨äºè®¾å®šçš„PDFé¡µé¢å±æ€§**:
| PDFå±æ€§ | è®¡ç®—å…¬å¼ | è¯´æ˜ |
|---------|----------|------|
| å­—ç¬¦å¹³å‡é—´è· | `avg_char_spacing * 1.5~2.0` | é—´è·çš„1.5-2å€ |
| å­—ç¬¦å¹³å‡å®½åº¦ | `avg_char_width * 0.8~1.5` | å®½åº¦çš„0.8-1.5å€ |
| å•è¯å¹³å‡é—´è· | `avg_word_gap * 0.4~0.6` | åº”å°äºå•è¯é—´è· |
| å­—ä½“ç±»å‹ | ç­‰å®½å­—ä½“ â†’ å‡å° | é—´è·å‡åŒ€ |
| å­—ä½“ç±»å‹ | æ¯”ä¾‹å­—ä½“ â†’ å¢å¤§ | é—´è·å˜åŒ–å¤§ |
| å­—ç¬¦å¯†åº¦ | ç´§å¯†æ’åˆ— â†’ å‡å° | ç²¾ç¡®åˆ†å‰² |
| å­—ç¬¦å¯†åº¦ | ç¨€ç–æ’åˆ— â†’ å¢å¤§ | å®¹å¿é—´è· |

**æ¨èèŒƒå›´**: 1.0 ~ 10.0 ç‚¹

**æ¨èè®¾ç½®é€»è¾‘**:
```python
# å¤šé‡çº¦æŸå–æœ€å°å€¼
text_x_tol = min(
    avg_char_spacing * 1.5,   # åŸºäºå­—ç¬¦é—´è·
    avg_word_gap * 0.5,       # ä¸è¶…è¿‡å•è¯é—´è·çš„50%
    avg_char_width * 1.2      # ä¸è¶…è¿‡å­—ç¬¦å®½åº¦çš„1.2å€
)
text_x_tolerance = max(1, min(text_x_tol, 10))
```

---

#### 10. text_y_tolerance

**å®˜æ–¹å®šä¹‰**:
> When using text strategy, individual letters in each word are expected to be no more than text_y_tolerance points apart vertically.

**ä¸­æ–‡ç¿»è¯‘**:
å½“ä½¿ç”¨æ–‡æœ¬ç­–ç•¥æ—¶ï¼ŒåŒä¸€å•è¯ä¸­çš„å­—ç¬¦å‚ç›´åå·®ä¸åº”è¶…è¿‡text_y_toleranceç‚¹æ•°ã€‚

**ä½œç”¨**:
- æ§åˆ¶å­—ç¬¦å¦‚ä½•ç»„åˆæˆè¡Œ
- å®¹å¿åŸºçº¿è½»å¾®åç§»
- å½±å“è¡Œè¯†åˆ«å‡†ç¡®æ€§

**å·¥ä½œåŸç†**:
```python
# åœ¨ page.extract_words() ä¸­ä½¿ç”¨
def extract_words(chars, y_tolerance):
    """
    1. èšç±»å­—ç¬¦åˆ°è¡Œ:
       - å¦‚æœå­—ç¬¦ top åæ ‡å·®å¼‚ <= y_tolerance
       â†’ è§†ä¸ºåŒä¸€è¡Œ
    2. æ¯è¡Œå†…æŒ‰ x åæ ‡æ’åºå­—ç¬¦
    3. ç»„åˆå­—ç¬¦ä¸ºå•è¯
    """
```

**ç¤ºä¾‹**:
```python
# åœºæ™¯ï¼šå­—ç¬¦åŸºçº¿å¯¹é½
åŒä¸€è¡Œçš„å­—ç¬¦:
  'H' at top=100.0
  'e' at top=100.5  # è½»å¾®åç§»0.5pt
  'l' at top=99.8   # è½»å¾®åç§»0.2pt
  'l' at top=100.1  # è½»å¾®åç§»0.1pt
  'o' at top=100.3  # è½»å¾®åç§»0.3pt

ä¸‹ä¸€è¡Œ:
  'W' at top=115.0  # è¡Œé—´è·15pt

è®¾ç½® text_y_tolerance=1:
  â†’ H-e-l-l-o éƒ½åœ¨å®¹å·®å†… (æœ€å¤§åå·®0.5ptâ‰¤1) â†’ åŒä¸€è¡Œ âœ…
  â†’ W ä¸åœ¨å®¹å·®å†… (åå·®15pt>1) â†’ ä¸‹ä¸€è¡Œ âœ…

è®¾ç½® text_y_tolerance=0.3:
  â†’ H, l, l åœ¨å®¹å·®å†… â†’ åŒä¸€è¡Œ
  â†’ e (0.5pt) è¶…å‡ºå®¹å·® â†’ è¯†åˆ«ä¸ºä¸åŒè¡Œ âŒ
  â†’ è¡Œè¢«é”™è¯¯åˆ†å‰² âŒ
```

**å½±å“èŒƒå›´**:
- â­â­â­â­ è¡Œè¯†åˆ«å‡†ç¡®æ€§
- â­â­â­ å¤šè¡Œæ–‡æœ¬åˆ†ç¦»
- â­â­â­ ä¸Šä¸‹æ ‡å¤„ç†
- âš ï¸ **é£é™©**: è¿‡å¤§å¯èƒ½åˆå¹¶å¤šè¡Œï¼Œè¿‡å°å¯èƒ½åˆ†å‰²åŒä¸€è¡Œ

**å¯ç”¨äºè®¾å®šçš„PDFé¡µé¢å±æ€§**:
| PDFå±æ€§ | è®¡ç®—å…¬å¼ | è¯´æ˜ |
|---------|----------|------|
| å­—ç¬¦å¹³å‡é«˜åº¦ | `avg_char_height * 0.2~0.4` | é«˜åº¦çš„20-40% |
| è¡Œé«˜ | `line_height * 0.15~0.25` | è¡Œé«˜çš„15-25% |
| åŸºçº¿æŠ–åŠ¨ | `baseline_jitter_std * 2~3` | è¦†ç›–2-3å€æ ‡å‡†å·® |
| PDFè´¨é‡ | é«˜è´¨é‡ â†’ å‡å° (1~3) | åŸºçº¿ç¨³å®š |
| PDFè´¨é‡ | ä½è´¨é‡ â†’ å¢å¤§ (3~6) | å®¹å¿åå·® |
| æ‰«æPDF | æ‰«æ â†’ å¢å¤§ (4~8) | å¯¹é½è¯¯å·®å¤§ |
| å­—ä½“å¤§å° | å°å­—ä½“ â†’ å‡å° | æŒ‰æ¯”ä¾‹ç¼©æ”¾ |

**æ¨èèŒƒå›´**: 1.0 ~ 10.0 ç‚¹

**æ¨èè®¾ç½®é€»è¾‘**:
```python
# ä¼˜å…ˆä½¿ç”¨è¡Œé«˜ï¼Œå›é€€åˆ°å­—ç¬¦é«˜åº¦
if line_height > 0:
    text_y_tol = line_height * 0.2  # è¡Œé«˜çš„20%
else:
    text_y_tol = avg_char_height * 0.3  # å­—ç¬¦é«˜åº¦çš„30%

text_y_tolerance = max(1, min(text_y_tol, 8))
```

---

## ğŸ“Š å‚æ•°å¿«é€Ÿå‚è€ƒè¡¨

### å‚æ•°ä¼˜å…ˆçº§ä¸å½±å“èŒƒå›´

| å‚æ•° | é€‚ç”¨æ¨¡å¼ | å½±å“çº§åˆ« | æ¨èèŒƒå›´ | ä¸»è¦ä¾æ® |
|------|----------|---------|---------|---------|
| `vertical_strategy` | é€šç”¨ | â­â­â­â­â­ | lines/text | å‚ç›´çº¿æ¡æ•°é‡ |
| `horizontal_strategy` | é€šç”¨ | â­â­â­â­â­ | lines/text | æ°´å¹³çº¿æ¡æ•°é‡ |
| `snap_tolerance` | ä¸¤ç§æ¨¡å¼ | â­â­â­â­ | 0.5~5.0 | å­—ç¬¦æœ€å°å°ºå¯¸ |
| `join_tolerance` | ä¸¤ç§æ¨¡å¼ | â­â­â­â­ | 1.0~10.0 | ç«¯ç‚¹æœ€å°è·ç¦» |
| `edge_min_length` | ä¸¤ç§æ¨¡å¼ | â­â­â­ | 1.0~30.0 | å­—ç¬¦æœ€å°å°ºå¯¸ |
| `intersection_tolerance` | ä¸¤ç§æ¨¡å¼ | â­â­â­â­â­ | 1.0~10.0 | å­—ç¬¦æœ€å°å°ºå¯¸ |
| `min_words_vertical` | Textæ¨¡å¼ | â­â­â­â­ | 2~10 | æ–‡æœ¬è¡Œæ•° |
| `min_words_horizontal` | Textæ¨¡å¼ | â­â­â­ | 1~5 | è¡¨æ ¼åˆ—æ•° |
| `text_x_tolerance` | Textæ¨¡å¼ | â­â­â­â­ | 1.0~10.0 | å­—ç¬¦é—´è· |
| `text_y_tolerance` | Textæ¨¡å¼ | â­â­â­â­ | 1.0~10.0 | è¡Œé«˜/å­—ç¬¦é«˜åº¦ |

### å‚æ•°è®¡ç®—ä¼˜å…ˆçº§å»ºè®®

**é«˜ä¼˜å…ˆçº§ (P0)**: ç›´æ¥å½±å“è¡¨æ ¼è¯†åˆ«æˆåŠŸç‡
1. `vertical_strategy` / `horizontal_strategy`
2. `intersection_tolerance`
3. `min_words_vertical` (Textæ¨¡å¼)

**ä¸­ä¼˜å…ˆçº§ (P1)**: å½±å“è¯†åˆ«è´¨é‡
4. `snap_tolerance`
5. `join_tolerance`
6. `edge_min_length`
7. `text_x_tolerance` / `text_y_tolerance` (Textæ¨¡å¼)

**ä½ä¼˜å…ˆçº§ (P2)**: è¾…åŠ©ä¼˜åŒ–
8. `min_words_horizontal` (Textæ¨¡å¼)

---

## ğŸ’¡ å‚æ•°è®¾å®šæœ€ä½³å®è·µ

### 1. åŸºäºå­—ç¬¦å°ºå¯¸çš„å‚æ•°è®¾å®š

**æ¨èæ–¹æ³•**: æ’é™¤è£…é¥°æ€§çº¿æ¡ï¼Œä½¿ç”¨å­—ç¬¦æœ€å°å°ºå¯¸

```python
# æ­¥éª¤1: è·å–å­—ç¬¦ç»Ÿè®¡
chars = page.chars
char_widths = [c['width'] for c in chars]
char_heights = [c['height'] for c in chars]

# æ­¥éª¤2: è®¡ç®—æœ€å°å°ºå¯¸ (æ’é™¤å¼‚å¸¸å€¼)
min_char_width = np.percentile(char_widths, 5)   # 5åˆ†ä½æ•°
min_char_height = np.percentile(char_heights, 5)
avg_char_width = np.mean(char_widths)
avg_char_height = np.mean(char_heights)

# æ­¥éª¤3: è®¡ç®—å‚æ•°
snap_tolerance = min(min_char_width, min_char_height) * 0.3
edge_min_length = min_char_width * 0.8
intersection_tolerance = avg_char_width * 0.5
```

### 2. æœ‰æ¡†vsæ— æ¡†è¡¨æ ¼å‚æ•°å·®å¼‚

```python
# æœ‰æ¡†è¡¨æ ¼
bordered_params = {
    "vertical_strategy": "lines",
    "horizontal_strategy": "text",
    "snap_tolerance": 2.0,
    "join_tolerance": 3.0,
    "edge_min_length": 5.0,      # ä¿ç•™çŸ­è¾¹æ¡†
    "intersection_tolerance": 3.0,
}

# æ— æ¡†è¡¨æ ¼
unbordered_params = {
    "vertical_strategy": "text",
    "horizontal_strategy": "text",
    "snap_tolerance": 1.5,
    "join_tolerance": 2.0,
    "edge_min_length": 10.0,     # è¿‡æ»¤è£…é¥°çº¿
    "intersection_tolerance": 3.0,
    "min_words_vertical": 3,
    "min_words_horizontal": 2,
    "text_x_tolerance": 3.0,
    "text_y_tolerance": 3.0,
}
```

### 3. PDFè´¨é‡è‡ªé€‚åº”

```python
# æ£€æµ‹PDFç±»å‹
is_scanned = detect_scanned_pdf(page)
line_quality = calculate_line_quality(page.lines)

if is_scanned or line_quality < 0.7:
    # ä½è´¨é‡PDF - å¢å¤§å®¹å·®
    multiplier = 1.5
else:
    # é«˜è´¨é‡PDF - å‡å°å®¹å·®
    multiplier = 0.8

params = {
    "snap_tolerance": base_snap * multiplier,
    "join_tolerance": base_join * multiplier,
    "intersection_tolerance": base_inter * multiplier,
}
```

### 4. åŠ¨æ€Strategyé€‰æ‹©

```python
# ç»Ÿè®¡çº¿æ¡æ•°é‡
h_lines = [l for l in page.lines if l['height'] < 2]
v_lines = [l for l in page.lines if l['width'] < 2]

# åŠ¨æ€é€‰æ‹©
if len(v_lines) >= 5:
    vertical_strategy = "lines"
else:
    vertical_strategy = "text"

if len(h_lines) >= 10:
    horizontal_strategy = "lines"
else:
    horizontal_strategy = "text"
```

---

## âš ï¸ å¸¸è§é™·é˜±ä¸æ³¨æ„äº‹é¡¹

### 1. è£…é¥°æ€§çº¿æ¡å¹²æ‰°

**é—®é¢˜**: æœ‰é—´è·è¾ƒå¤§çš„è£…é¥°æ€§çº¿æ¡

**é”™è¯¯åšæ³•**:
```python
# âŒ åŸºäºçº¿æ¡é—´è·è®¾å®šå‚æ•°
line_spacings = calculate_line_spacings(page.lines)
snap_tolerance = min(line_spacings) * 0.1  # è¢«è£…é¥°çº¿è¯¯å¯¼
```

**æ­£ç¡®åšæ³•**:
```python
# âœ… åŸºäºå­—ç¬¦å°ºå¯¸è®¾å®šå‚æ•°
min_char_size = min(min_char_width, min_char_height)
snap_tolerance = min_char_size * 0.3  # ä¸å—è£…é¥°çº¿å½±å“
```

### 2. å‚æ•°è¿‡å¤§å¯¼è‡´é”™è¯¯åˆå¹¶

**é—®é¢˜**: snap_toleranceè¿‡å¤§

**ç°è±¡**:
```
ä¸åŒåˆ—çš„çº¿æ¡è¢«é”™è¯¯åˆå¹¶
Col1 at x=100 â”€â”€â”€â”€â”
Col2 at x=108 â”€â”€â”€â”€â”¤ snap_tolerance=10 â†’ åˆå¹¶åˆ°x=104
Col3 at x=112 â”€â”€â”€â”€â”˜
â†’ ä¸‰åˆ—è¢«è¯†åˆ«ä¸ºä¸€åˆ— âŒ
```

**è§£å†³æ–¹æ¡ˆ**: ä½¿ç”¨å­—ç¬¦æœ€å°å°ºå¯¸ä½œä¸ºä¸Šé™
```python
snap_tolerance = min(calculated_value, min_char_width * 0.5)
```

### 3. Textæ¨¡å¼å‚æ•°ä¸å½“

**é—®é¢˜**: min_words_verticalè¿‡å°

**ç°è±¡**:
```
é¡µé¢æœ‰å¶ç„¶å¯¹é½çš„å•è¯
æ ‡é¢˜ "ç¬¬ä¸€ç« "  at x=200  â”€â”
æ­£æ–‡å•è¯     at x=201  â”€â”¤ min_words_vertical=2
                        â””â†’ è¢«è¯¯è¯†åˆ«ä¸ºåˆ—è¾¹ç•Œ âŒ
```

**è§£å†³æ–¹æ¡ˆ**: è®¾ç½®åˆç†ä¸‹é™
```python
min_words_vertical = max(3, calculated_value)  # è‡³å°‘3ä¸ªå•è¯
```

### 4. å¿½ç•¥intersection_tolerance

**é—®é¢˜**: åªè®¾ç½®snapå’Œjoinï¼Œå¿½ç•¥intersection

**ç°è±¡**:
```
çº¿æ¡å·²æ­£ç¡®åˆå¹¶å’Œè¿æ¥
ä½†äº¤ç‚¹åˆ¤å®šè¿‡äºä¸¥æ ¼
â†’ æ— æ³•è¯†åˆ«å•å…ƒæ ¼ âŒ
```

**è§£å†³æ–¹æ¡ˆ**: ä¿æŒintersection_tolerance >= snap_tolerance
```python
intersection_tolerance = max(snap_tolerance, avg_char_width * 0.5)
```

---

## ğŸ”¬ å‚æ•°è°ƒè¯•å»ºè®®

### è°ƒè¯•æµç¨‹

```python
# 1. å¯è§†åŒ–edges
import pdfplumber
from pdfplumber.utils import draw_edges

pdf = pdfplumber.open('test.pdf')
page = pdf.pages[0]

# æµ‹è¯•ä¸åŒå‚æ•°
params = {
    "snap_tolerance": 2,
    "join_tolerance": 3,
    "edge_min_length": 5,
}

# è·å–edges
table_finder = page.find_tables(params)
edges = table_finder.edges

# å¯è§†åŒ–
im = page.to_image()
im.draw_lines(edges)
im.show()

# 2. æ£€æŸ¥äº¤ç‚¹
intersections = table_finder.intersections
print(f"Found {len(intersections)} intersections")

# 3. æ£€æŸ¥å•å…ƒæ ¼
cells = table_finder.cells
print(f"Found {len(cells)} cells")

# 4. æ£€æŸ¥è¡¨æ ¼
tables = table_finder.tables
print(f"Found {len(tables)} tables")
```

### å¸¸è§è°ƒè¯•è¾“å‡º

```python
# è¯Šæ–­è¾“å‡º
def diagnose_params(page, params):
    finder = page.find_tables(params)
    
    print(f"Edges: {len(finder.edges)}")
    print(f"  - Horizontal: {len([e for e in finder.edges if e['orientation']=='h'])}")
    print(f"  - Vertical: {len([e for e in finder.edges if e['orientation']=='v'])}")
    print(f"Intersections: {len(finder.intersections)}")
    print(f"Cells: {len(finder.cells)}")
    print(f"Tables: {len(finder.tables)}")
    
    if len(finder.tables) == 0:
        print("\nâš ï¸ No tables found! Try:")
        print("  1. Decrease edge_min_length")
        print("  2. Increase snap_tolerance")
        print("  3. Increase intersection_tolerance")
        print("  4. Check strategy selection")
```

---

## ğŸ“š å‚è€ƒèµ„æº

### å®˜æ–¹æ–‡æ¡£
- **pdfplumber GitHub**: https://github.com/jsvine/pdfplumber
- **Table Extraction Settings**: https://github.com/jsvine/pdfplumber#table-extraction-settings
- **æºä»£ç **: `pdfplumber/table.py`

### ç›¸å…³ç®—æ³•è®ºæ–‡
- Anssi Nurminen's Master's Thesis on Table Extraction
- Tabula Table Extraction Algorithm

### å·¥å…·èµ„æº
- **pdfplumberè°ƒè¯•å·¥å…·**: `page.to_image()` å¯è§†åŒ–
- **åœ¨çº¿æµ‹è¯•**: PDFPlumberçš„Jupyter Notebookç¤ºä¾‹

---

**æ–‡æ¡£ç»´æŠ¤**:
- ç‰ˆæœ¬: v1.0
- åˆ›å»º: 2025-10-30
- ä½œè€…: AIç¼–ç¨‹åŠ©æ‰‹
- åŸºäº: pdfplumberæºä»£ç åˆ†æ

**æ³¨**: æœ¬æ–‡æ¡£ä¸“æ³¨äºpdfplumberå®˜æ–¹æœºåˆ¶è¯´æ˜ï¼Œä¸åŒ…å«å…·ä½“å·¥ç¨‹å®ç°ã€‚

